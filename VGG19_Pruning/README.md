# Pruning Using Torch-Pruning (VGG19 / ResNet examples)

This folder contains a small example of structured pruning using torch-pruning (VainF). It uses helper utilities in `cls_net_utils.py` and the pruning driver `vgg19_prune.py`.

## Quick checklist
- Install deps: 
```bash
pip install torch torchvision torch-pruning
```
- Ensure CUDA/PyTorch versions match your system.
- Keep a saved baseline (unpruned) checkpoint before running pruning.

## Files to know
- `cls_net_utils.py` — dataset loaders (CIFAR-10), model builders, training & eval helpers.
- `vgg19_prune.py` — pruning driver (Taylor / Magnitude pruning hooks, finetune loop).
- (Optional) Inspect scripts: print layer channels or inspect pruned model.

## Run example (CIFAR-10)
- Finetune the Imagenet1k weight from pytorch model library to CIFAR10 model and Prune.
```bash
python3 vgg19_prune.py --data-dir data_cls --epochs 10 --batch-size 32 --workers 1 --lr 0.001 --prune --prune-ratio 0.5 --iter-steps 5 --round-to 4 --finetune-epochs 3
```
Make sure to nativate `vgg19_prune.py` file to pass the arguments as per your requirements.

- Post train the pruned model
```bash
python3 vgg19_prune.py --data-dir data_cls --epochs 10 --batch-size 32 --workers 1 --lr 0.001 --round-to 4 --finetune-model <Absolute Path to pruned '.pth' file generated by vgg19_prune.py script > 
```


